{% extends 'core/base.html' %}
{% load static humanize %}

{% block content %}
<!-- Hero Section with Slider -->
<div class="hero-section">
  <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="{% static 'images/banner1.jpg' %}" class="d-block w-100" alt="Happy Chickens">
        <div class="carousel-caption">
          <h1 class="animate__animated animate__fadeInDown">Ufugaji Bora wa Kuku</h1>
          <p class="animate__animated animate__fadeInUp animate__delay-1s">Tunakuletea mifugo bora na mayai yenye virutubisho vya hali ya juu</p>
          <a href="#products" class="btn btn-primary btn-lg mt-3 animate__animated animate__fadeInUp animate__delay-2s">Nunua Sasa</a>
        </div>
      </div>
      <div class="carousel-item">
        <img src="{% static 'images/banner2.jpg' %}" class="d-block w-100" alt="Fresh Eggs">
        <div class="carousel-caption">
          <h1 class="animate__animated animate__fadeInDown">Mayai Safi na Matamu</h1>
          <p class="animate__animated animate__fadeInUp animate__delay-1s">Yaliyofugwa kwa uangalifu bila kemikali</p>
          <a href="#products" class="btn btn-success btn-lg mt-3 animate__animated animate__fadeInUp animate__delay-2s">Angalia Bidhaa</a>
        </div>
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
</div>

<!-- Featured Products -->
<section id="products" class="py-5 bg-light">
  <div class="container">
    <div class="section-header text-center mb-5">
      <h2 class="display-4">Bidhaa Zetu</h2>
      <p class="lead">Chagua kati ya bidhaa zetu bora</p>
    </div>
    
    <div class="row g-4">
      <!-- Chicken Product Card -->
      <div class="col-md-6 col-lg-4" data-aos="fade-up">
        <div class="card product-card h-100 border-0 shadow-sm">
          <div class="badge bg-danger position-absolute" style="top: 10px; right: 10px;">Inapatikana</div>
          <img src="{% static 'images/banner1.jpg' %}" class="card-img-top" alt="Kuku wa Kienyeji">
          <div class="card-body">
            <h5 class="card-title">Kuku wa Kienyeji</h5>
            <p class="card-text">Kuku wa asili, waliokuzwa kwa uangalifu na lisila bora bila kemikali.</p>
            <div class="d-flex justify-content-between align-items-center">
              <span class="h4 text-primary">TZS 15,000</span>
              <button class="btn btn-outline-primary add-to-cart" data-product="1">Weka kwenye Cart</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Eggs Product Card -->
      <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="100">
        <div class="card product-card h-100 border-0 shadow-sm">
          <div class="badge bg-danger position-absolute" style="top: 10px; right: 10px;">Inapatikana</div>
          <img src="{% static 'images/banner7.jpg' %}" class="card-img-top" alt="Mayai ya Kienyeji">
          <div class="card-body">
            <h5 class="card-title">Mayai ya Kienyeji</h5>
            <p class="card-text">Mayai safi yenye virutubisho vingi, yaliyotoka kwa kuku wa kienyeji.</p>
            <div class="d-flex justify-content-between align-items-center">
              <span class="h4 text-primary">TZS 500 / yai</span>
              <div class="input-group" style="width: 120px;">
                <button class="btn btn-outline-secondary minus-btn" type="button">-</button>
                <input type="number" class="form-control text-center quantity-input" value="1" min="1">
                <button class="btn btn-outline-secondary plus-btn" type="button">+</button>
              </div>
              <button class="btn btn-outline-primary add-to-cart" data-product="2">Weka Cart</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Feed Product Card -->
      <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="200">
        <div class="card product-card h-100 border-0 shadow-sm">
          <img src="{% static 'images/banner2.jpg' %}" class="card-img-top" alt="Chakula cha Kuku">
          <div class="card-body">
            <h5 class="card-title">Chakula cha Kuku</h5>
            <p class="card-text">Lisila bora la protini 18%, lenye virutubisho vyote muhimu kwa ukuaji wa kuku.</p>
            <div class="d-flex justify-content-between align-items-center">
              <span class="h4 text-primary">TZS 35,000 / mfuko</span>
              <button class="btn btn-outline-primary add-to-cart" data-product="3">Weka Cart</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- Dashboard Overview -->
<div class="container-fluid py-4">
  <div class="row">
    <!-- Main Cards -->
    {% for card in cards %}
    <div class="col-xl-2 col-md-4 mb-4">
      <div class="card border-left-{{ card.color }} shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
              <div class="text-xs font-weight-bold text-{{ card.color }} text-uppercase mb-1">
                {{ card.title }}</div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">{{ card.value|intcomma }}</div>
            </div>
            <div class="col-auto">
              <i class="{{ card.icon }} fa-2x text-gray-300"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Production Charts Row -->
  <div class="row">
    <!-- Weekly Egg Production -->
    <div class="col-xl-6 col-lg-6">
      <div class="card shadow mb-4">
        <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
          <h6 class="m-0 font-weight-bold text-primary">Uzalishaji wa Mayai Wiki Hii</h6>
        </div>
        <div class="card-body">
          <h4 class="small font-weight-bold">
            Mayai: <span class="float-right">{{ weekly_eggs }}/{{ weekly_target }}</span>
          </h4>
          <div class="progress mb-4">
            <div class="progress-bar bg-success" role="progressbar" 
                 style="width: {{ weekly_progress }}%" 
                 aria-valuenow="{{ weekly_progress }}" 
                 aria-valuemin="0" 
                 aria-valuemax="100"></div>
          </div>
          <canvas id="eggProductionChart" height="200"></canvas>
        </div>
      </div>
    </div>

    <!-- Chicken Health Status -->
    <div class="col-xl-6 col-lg-6">
      <div class="card shadow mb-4">
        <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
          <h6 class="m-0 font-weight-bold text-primary">Hali ya Afya ya Kuku</h6>
        </div>
        <div class="card-body">
          <canvas id="healthStatusChart" height="200"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity Tables -->
  <div class="row">
    <!-- Recent Feedings -->
    <div class="col-lg-6 mb-4">
      <div class="card shadow mb-4">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Ulishaji wa Hivi Karibuni</h6>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-bordered" width="100%" cellspacing="0">
              <thead>
                <tr>
                  <th>Kuku</th>
                  <th>Chakula</th>
                  <th>Wakati</th>
                  <th>Kiasi</th>
                </tr>
              </thead>
              <tbody>
                {% for feeding in recent_feedings %}
                <tr>
                  <td>{{ feeding.chicken.name }}</td>
                  <td>{{ feeding.feed_type }}</td>
                  <td>{{ feeding.feeding_time|date:"H:i" }}</td>
                  <td>{{ feeding.amount }}g</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Health Checkups -->
    <div class="col-lg-6 mb-4">
      <div class="card shadow mb-4">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Ukaguzi wa Afya wa Hivi Karibuni</h6>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-bordered" width="100%" cellspacing="0">
              <thead>
                <tr>
                  <th>Kuku</th>
                  <th>Tarehe</th>
                  <th>Hali</th>
                  <th>Matibabu</th>
                </tr>
              </thead>
              <tbody>
                {% for checkup in recent_health_checks %}
                <tr>
                  <td>{{ checkup.chicken.name }}</td>
                  <td>{{ checkup.checkup_date|date:"M d" }}</td>
                  <td>
                    <span class="badge badge-{% if checkup.status == 'healthy' %}success{% else %}danger{% endif %}">
                      {{ checkup.get_status_display }}
                    </span>
                  </td>
                  <td>{{ checkup.treatment|default:"-"|truncatechars:20 }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Why Choose Us -->
<section class="py-5 bg-white">
  <div class="container">
    <div class="section-header text-center mb-5">
      <h2 class="display-4">Kwa Nini Kuchagua Sisi?</h2>
    </div>
    
    <div class="row g-4">
      <div class="col-md-4" data-aos="fade-up">
        <div class="feature-box text-center p-4">
          <div class="feature-icon mb-3">
            <i class="fas fa-award fa-3x text-primary"></i>
          </div>
          <h4>Ubora wa Juu</h4>
          <p>Bidhaa zetu zina ubora wa hali ya juu na zimefanyiwa uchunguzi wa kina.</p>
        </div>
      </div>
      
      <div class="col-md-4" data-aos="fade-up" data-aos-delay="100">
        <div class="feature-box text-center p-4">
          <div class="feature-icon mb-3">
            <i class="fas fa-truck fa-3x text-primary"></i>
          </div>
          <h4>Uwasilishaji wa Haraka</h4>
          <p>Mipango yetu ya uwasilishaji inahakikisha bidhaa zako zinafika kwa wakati.</p>
        </div>
      </div>
      
      <div class="col-md-4" data-aos="fade-up" data-aos-delay="200">
        <div class="feature-box text-center p-4">
          <div class="feature-icon mb-3">
            <i class="fas fa-headset fa-3x text-primary"></i>
          </div>
          <h4>Msaada wa 24/7</h4>
          <p>Timu yetu ya wataalam iko tayari kukusaidia saa zote.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Testimonials -->
<section class="py-5 bg-light">
  <div class="container">
    <div class="section-header text-center mb-5">
      <h2 class="display-4">Maoni ya Wateja</h2>
      <p class="lead">Wateja wetu wanachosema kuhusu sisi</p>
    </div>
    
    <div class="row">
      <div class="col-12">
        <div id="testimonialCarousel" class="carousel slide" data-bs-ride="carousel">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <div class="testimonial-item text-center p-4">
                <img src="{% static 'images/banner5.jpg' %}" class="rounded-circle mb-3" width="100" alt="Client">
                <p class="lead">"Mayai yao ni matamu na ninaamini ni salama kwa familia yangu. Nimekuwa mtewa wa mda mrefu!"</p>
                <h5>Juma Mwinyi</h5>
                <div class="stars text-warning">
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="testimonial-item text-center p-4">
                <img src="{% static 'images/banner6.jpg' %}" class="rounded-circle mb-3" width="100" alt="Client">
                <p class="lead">"Kuku wao wa kienyeji ni wa kipekee. Wamekuwa na afya nzuri na wanatoa mayai mengi."</p>
                <h5>Asha Salim</h5>
                <div class="stars text-warning">
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star-half-alt"></i>
                </div>
              </div>
            </div>
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#testimonialCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#testimonialCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Order Now CTA -->
<section class="py-5 bg-primary text-white">
  <div class="container text-center">
    <h2 class="display-4 mb-4">Tayari Kuweka Order?</h2>
    <p class="lead mb-4">Wasiliana nasi sasa hivi kwa huduma bora na bei nafuu</p>
    <div class="d-flex justify-content-center gap-3">
      <a href="tel:+255123456789" class="btn btn-light btn-lg">
        <i class="fas fa-phone-alt me-2"></i> Tuite +255 123 456 789
      </a>
      <a href="https://wa.me/255123456789" class="btn btn-success btn-lg">
        <i class="fab fa-whatsapp me-2"></i> WhatsApp
      </a>
    </div>
  </div>
</section>

<!-- CSS Styles -->
<style>
  /* Hero Section */
  .hero-section {
    position: relative;
    height: 80vh;
    overflow: hidden;
  }
  
  .hero-section .carousel-item {
    height: 80vh;
  }
  
  .hero-section .carousel-item img {
    object-fit: cover;
    height: 100%;
    filter: brightness(0.7);
  }
  
  .hero-section .carousel-caption {
    bottom: 30%;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
  }
  
  /* Product Cards */
  .product-card {
    transition: transform 0.3s ease;
    border-radius: 10px;
    overflow: hidden;
  }
  
  .product-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
  }
  
  .product-card img {
    height: 250px;
    object-fit: cover;
    transition: transform 0.5s ease;
  }
  
  .product-card:hover img {
    transform: scale(1.05);
  }
  
  /* Feature Boxes */
  .feature-box {
    background: #f8f9fa;
    border-radius: 10px;
    transition: all 0.3s ease;
    height: 100%;
  }
  
  .feature-box:hover {
    background: #fff;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    transform: translateY(-5px);
  }
  
  /* Testimonials */
  .testimonial-item {
    background: white;
    border-radius: 10px;
    max-width: 800px;
    margin: 0 auto;
  }
  
  /* Animations */
  [data-aos] {
    transition: opacity 0.5s ease, transform 0.5s ease;
  }
  
  .floating {
    animation: floating 3s ease-in-out infinite;
  }
  
  @keyframes floating {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-15px); }
    100% { transform: translateY(0px); }
  }
</style>

<!-- JavaScript for Interactive Elements -->
<script>
  // Initialize AOS animations
  AOS.init({
    duration: 800,
    easing: 'ease-in-out',
    once: true
  });
  
  // Product quantity controls
  document.querySelectorAll('.plus-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const input = btn.parentElement.querySelector('.quantity-input');
      input.value = parseInt(input.value) + 1;
    });
  });
  
  document.querySelectorAll('.minus-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const input = btn.parentElement.querySelector('.quantity-input');
      if (parseInt(input.value) > 1) {
        input.value = parseInt(input.value) - 1;
      }
    });
  });
  
  // Add to cart functionality
  document.querySelectorAll('.add-to-cart').forEach(btn => {
    btn.addEventListener('click', () => {
      const productId = btn.getAttribute('data-product');
      let quantity = 1;
      
      // For eggs which has quantity input
      const quantityInput = btn.closest('.card-body').querySelector('.quantity-input');
      if (quantityInput) {
        quantity = parseInt(quantityInput.value);
      }
      
      // Here you would typically make an AJAX call to add to cart
      alert(`Added product ${productId} (quantity: ${quantity}) to cart!`);
      
      // You can implement actual cart functionality with Django views
    });
  });
</script>
{% endblock %}